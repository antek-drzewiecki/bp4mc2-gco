# History, versioning and provenance
In the Catalogus, a distinction is made between formal history and material history. These two types of history are applied to all types of resources, albeit in a slightly different manner. For instance, each concept in a dataset has its own history, whereas a datamodel is published as a whole and therefore only the history of that datamodel is recorded, as opposed to the history of all its individual components.

The [NEN3610-standard](http://www.geonovum.nl/wegwijzer/standaarden/basismodel-geo-informatie-nen36102011) defines the **formal history** of an object as the history of its registration. In the Catalogus, the formal history of a concept consists of its different versions that were stored there. Each change to a concept results in a new version. A certain set of **provenance information** is documented for each change, most notably the date/time when it occurred and information about who made the change.

The **material history** of an object is defined by the same NEN3610-standard as the history of that object in reality. In the Catalogus, we document the legality of a concept. Each concept has a legal status; changes in legal status usually occur at a given time. The material history of a concept documents just that. It is worth mentioning that there are no restrictions on the dates that can be entered regarding changes in (legal) status of a concept. For instance, at the time of registration, a concept can be legalized retroactively, but also not be legal yet until a certain date in the future.

## Formal history and versioning
Formal history is recorded for each concept in the Catalogus. Each change to a concept results in a new version. A concept is considered changed when there has been a change in one of the triples with that concept as subject. That can either be a change in the predicate or object, a newly added triple or a deleted triple.

For each version of a concept, there are two triples relating to its formal history:
- one signifying the start of the formal history, denoted by the predicate `prov:generatedAtTime`. This triple has a *set of changes* as its subject (which is a `prov:Entity`).
- one signifying the end, denoted by the predicate `prov:invalidatedAtTime`. This triple has the concept itself as its subject.

The latter triple is only present if the considerated version of the concept is not the most recent one.

The technical implementation of formal history (i.e. versioning) in the Catalogus is documented in [implementation.md](implementation.md).

## Material history
As said, the material history of a concept addresses its legality. There are several dates relevant to the legality of a concept and several legal statuses a concept can have, such as *announced*, *valid*, *deprecated* etc. For now, the Catalogus only stores the period of time a concept is (legally) valid. For this, the predicate `dcterms:valid` is used, which expects a date range as object.

In practice, by choosing this implementation, the material history of a concept is included in its data model. This is an important principle which can be used to also register other types of history by means of simply extending the data model.

## Provenance
For each **set of changes** to a dataset, the following provenance information is stored:
- The set of changes itself is a `prov:Entity`, denoted by the predicate `rdf:type`
- The set of changes is generated by a `prov:Activity`, denoted by the predicate `prov:wasGeneratedBy`
- The set of changes signifies the start of the formal history of the (version of) the concept(s) in the set. Therefore, the set of changes is the subject of a triple signifying this start, denoted by the predicate `prov:generatedAtTime`
- The activity which generates the set of changes has a start date/time, denoted by the predicate `prov:startedAtTime`. Since the activity of uploading a set of changes is considered instantaneous, only the start date/time is recorded, not the end date/time. For activities that have an actual duration, the end date/time could be recorded using the predicate `prov:endedAtTime`
- The activity is done by a `prov:Agent`, denoted by the predicate `prov:wasAssociatedWith`
- The agent doing the activity usually acts on behalf of an organization, denoted by the predicate `prov:actedOnBehalfOf`
